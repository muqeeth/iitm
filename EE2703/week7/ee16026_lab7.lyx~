#LyX 2.2 created this file. For more info see http://www.lyx.org/
\lyxformat 508
\begin_document
\begin_header
\save_transient_properties true
\origin unavailable
\textclass article
\use_default_options true
\maintain_unincluded_children false
\language english
\language_package default
\inputencoding auto
\fontencoding global
\font_roman "default" "default"
\font_sans "default" "default"
\font_typewriter "default" "default"
\font_math "auto" "auto"
\font_default_family default
\use_non_tex_fonts false
\font_sc false
\font_osf false
\font_sf_scale 100 100
\font_tt_scale 100 100
\graphics default
\default_output_format default
\output_sync 0
\bibtex_command default
\index_command default
\paperfontsize 12
\spacing single
\use_hyperref false
\papersize a4paper
\use_geometry true
\use_package amsmath 1
\use_package amssymb 1
\use_package cancel 1
\use_package esint 1
\use_package mathdots 1
\use_package mathtools 1
\use_package mhchem 1
\use_package stackrel 1
\use_package stmaryrd 1
\use_package undertilde 1
\cite_engine basic
\cite_engine_type default
\biblio_style plain
\use_bibtopic false
\use_indices false
\paperorientation portrait
\suppress_date false
\justification true
\use_refstyle 1
\index Index
\shortcut idx
\color #008000
\end_index
\leftmargin 1.25cm
\topmargin 1.25cm
\rightmargin 1.25cm
\bottommargin 1.25cm
\headheight 1.25cm
\headsep 1.25cm
\footskip 1.25cm
\secnumdepth 3
\tocdepth 3
\paragraph_separation indent
\paragraph_indentation default
\quotes_language english
\papercolumns 1
\papersides 1
\paperpagestyle default
\tracking_changes false
\output_changes false
\html_math_output 0
\html_css_as_file 0
\html_be_strict false
\end_header

\begin_body

\begin_layout Title
The Laplace Transform
\end_layout

\begin_layout Author
Mohammed Muqeeth
\begin_inset Newline newline
\end_inset

EE16B026
\begin_inset Newline newline
\end_inset

Electrical Engineering
\begin_inset Newline newline
\end_inset

IIT Madras
\end_layout

\begin_layout Abstract
Laplace Transform is a very powerful mathematical tool applied in various
 areas of engineering.We use laplace transform here to analyse linear time
 invariant systems with initial conditions using signal toolbox of Python.
\end_layout

\begin_layout Section
Introduction
\end_layout

\begin_layout Itemize
Python has a way to define polynomials of single variable.We can define a
 polynomial sending coefficients as arguments.
 Eg polyld([1,2,3]) constructs 
\begin_inset Formula $1.x^{2}+2.x+3$
\end_inset

.Similarly polyadd polymul commands add,multiply two polynomials given as
 argument.
 Eg polyadd([1,2],[1,2,3]) returns array([1,3,5]) which is 
\begin_inset Formula $1.x^{2}+3.x+5$
\end_inset

, polymul([[1,2],[1,2,3]) retuns array([1,4,7,6]) 
\begin_inset Formula $1.x^{3}+4.x^{2}+7.x+6$
\end_inset

.
\end_layout

\begin_layout Itemize
The signal toolbox of python has different functions.
 Eg lti,impulse,lsim required under scipy.signal module.Import scipy.signal
 as sp.
 Now sp has all functions listed in example.
\end_layout

\begin_layout Itemize
sp.lti helps to define a transfer function in rational form.
 Eg .H=sp.lti([1,2,3],[3,2,0,1]) defines transfer function of form 
\begin_inset Formula $H(s)=\frac{s^{2}+2s+3}{3s^{3}+2s^{2}+1}$
\end_inset

.The bode function on H returns frequency, magnitude , phase .Eg.
 w,S,phi = H.bode().which can be used for bode plots.
\end_layout

\begin_layout Itemize
sp.impulse functions retuns impulse response for a given transfer function.Eg.
 t,x=sp.impulse(H,None, linspace(0,10,101))
\end_layout

\begin_layout Itemize
sp.lsim does convolution of given input signal with impulse response of transfer
 function.
 Eg.
 t=linspace(0,10,101).
 u=sin(t).
 t,y,svec=sp.lsim(H,u,t)
\end_layout

\begin_layout Itemize
Here we take certain examples to illustrate above listed function of scipy.signal
 module.
\end_layout

\begin_layout Section
Time response of Spring .
\end_layout

\begin_layout Subsection
Method and Discussion
\end_layout

\begin_layout Itemize
Let us consider an lti system with input 
\begin_inset Formula $f(t)$
\end_inset

and output 
\begin_inset Formula $x(t)$
\end_inset

.The initial conditions are 
\begin_inset Formula $x(0)=0$
\end_inset

 and 
\begin_inset Formula $\dot{x}(0)=0$
\end_inset

.Laplace transform of Input 
\begin_inset Formula $f(t)=\cos(1.5t)\exp(-0.5t)u_{o}(t)$
\end_inset

 is given by 
\begin_inset Formula $F(s)=\frac{s+0.5}{(s+0.5)^{2}+2.25}$
\end_inset

The system satisfies differential equation given as
\begin_inset Formula 
\[
\ddot{x}+2.25x=f(t)
\]

\end_inset


\begin_inset Formula 
\[
s^{2}X(s)+2.25X(s)=F(s)
\]

\end_inset


\begin_inset Formula 
\[
X(s)=\frac{F(s)}{s^{2}+2.25}
\]

\end_inset


\end_layout

\begin_layout Itemize
We can use sp.impulse to find 
\begin_inset Formula $x(t)$
\end_inset

for above given 
\begin_inset Formula $X(s)$
\end_inset

.This method is repeated for 
\begin_inset Formula $f(t)=\cos(1.5t)\exp(-0.05t)u_{o}(t)$
\end_inset

 with laplace given as 
\begin_inset Formula $F(s)=\frac{s+0.05}{(s+0.05)^{2}+2.25}$
\end_inset

.
\end_layout

\begin_layout Itemize
Now we vary frequency of cosine in 
\begin_inset Formula $f(t)$
\end_inset

 from 1.4 to 1.6 in steps of 0.05.The transfer function of system 
\begin_inset Formula $H(s)=X(s)/F(s)=\frac{1}{s^{2}+2.25}$
\end_inset

.We use sp.lsim with arguments 
\begin_inset Formula $H(s)$
\end_inset

and input 
\begin_inset Formula $f(t)$
\end_inset

 to calculate 
\begin_inset Formula $x(t)$
\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement H
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Time response of spring for decay=0.5
\end_layout

\end_inset


\begin_inset Graphics
	filename Figure_0.png
	width 80page%
	height 40pheight%

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\begin_inset Float figure
placement H
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Time response of spring for smaller decay = 0.05
\end_layout

\end_inset


\begin_inset Graphics
	filename Figure_1.png
	width 80page%
	height 40pheight%

\end_inset


\end_layout

\end_inset


\begin_inset Float figure
placement H
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Time response varying frequency of cosine from 1.4 to 1.6
\end_layout

\end_inset


\begin_inset Graphics
	filename Figure_2.png
	width 80page%
	height 40pheight%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Graphics
	filename Figure_9.png
	width 80page%
	height 40theight%

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Itemize
The given system has poles on imaginary axis 1.5j and -1.5j.
 Therefore natural response never dies out.Since forcing function 
\begin_inset Formula $f(t)$
\end_inset

 decays with time .
 After long time, output will be dominated by natural response.
\end_layout

\begin_layout Itemize
From figure 1 and figure 2 we observe that response with smaller decay slowly
 rises whereas that of decay = 0.5 rises at beginning itself.
\end_layout

\begin_layout Itemize
Figure 3 has time response for different frequencies.For frequency of 1.5
 the amplitude peak is highest of all.
\end_layout

\begin_layout Subsection
Code
\end_layout

\begin_layout LyX-Code
#define transfer function X(s)
\end_layout

\begin_layout LyX-Code
#X(s) = s+0.5/(((s+0.5)*(s+0.5)+2.25]*[s*s+2.25))
\end_layout

\begin_layout LyX-Code
num = poly1d([1,0.5])
\end_layout

\begin_layout LyX-Code
den = polymul([1,1,2.5],[1,0,2.25])
\end_layout

\begin_layout LyX-Code
X = sp.lti(num,den)
\end_layout

\begin_layout LyX-Code
t,x=sp.impulse(X,None,linspace(0,50,501))
\end_layout

\begin_layout LyX-Code
plt.figure(0)
\end_layout

\begin_layout LyX-Code
title('time response of spring')
\end_layout

\begin_layout LyX-Code
xlabel('$t$',fontsize=20)
\end_layout

\begin_layout LyX-Code
ylabel('$x$',fontsize=20)
\end_layout

\begin_layout LyX-Code
plot(t,x)
\end_layout

\begin_layout LyX-Code
#define transfer function X(s)
\end_layout

\begin_layout LyX-Code
#X(s) = s+0.05/(((s+0.05)*(s+0.05)+2.25]*[s*s+2.25))
\end_layout

\begin_layout LyX-Code
num = poly1d([1,0.05])
\end_layout

\begin_layout LyX-Code
den = polymul([1,0.1,2.2525],[1,0,2.25])
\end_layout

\begin_layout LyX-Code
X = sp.lti(num,den)
\end_layout

\begin_layout LyX-Code
t,x=sp.impulse(X,None,linspace(0,50,501))
\end_layout

\begin_layout LyX-Code
plt.figure(1)
\end_layout

\begin_layout LyX-Code
title('time response of spring')
\end_layout

\begin_layout LyX-Code
xlabel('$t$',fontsize=20)
\end_layout

\begin_layout LyX-Code
ylabel('$x$',fontsize=20)
\end_layout

\begin_layout LyX-Code
plot(t,x)
\end_layout

\begin_layout LyX-Code
#probmem3
\end_layout

\begin_layout LyX-Code
for a in arange(1.4,1.65,0.05):
\end_layout

\begin_layout LyX-Code
    t =linspace(0,50,501)
\end_layout

\begin_layout LyX-Code
    u = cos(a*t)*exp(-0.05*t) 
\end_layout

\begin_layout LyX-Code
    num = poly1d([1])
\end_layout

\begin_layout LyX-Code
    den = poly1d([1,0,2.25])
\end_layout

\begin_layout LyX-Code
    H = sp.lti(num,den)
\end_layout

\begin_layout LyX-Code
    t,x,svec=sp.lsim(H,u,t)
\end_layout

\begin_layout LyX-Code
    plt.figure(2)
\end_layout

\begin_layout LyX-Code
    plot(t,x)
\end_layout

\begin_layout LyX-Code
title('time response for different frequencies')
\end_layout

\begin_layout LyX-Code
plt.legend(['$
\backslash
omega=1.4$','$
\backslash
omega=1.45$','$
\backslash
omega=1.5$','$
\backslash
omega=1.55$','$
\backslash
omega=1.6$'])
\end_layout

\begin_layout LyX-Code
xlabel('$t$')
\end_layout

\begin_layout LyX-Code
ylabel('$x$')
\end_layout

\begin_layout LyX-Code

\end_layout

\begin_layout Section
Coupled Spring Problem.
\end_layout

\begin_layout Subsection
Method and Discussion
\end_layout

\begin_layout Itemize
Consider a coupled spring which satisfies the differential equation with
 initial conditions 
\begin_inset Formula $x(0)=1,\dot{x}(0)=\dot{y}(0)=y(0)=0$
\end_inset

 given below 
\begin_inset Formula 
\[
\ddot{x}+(x-y)=0
\]

\end_inset


\begin_inset Formula 
\[
\ddot{y}+2(y-x)=0
\]

\end_inset


\end_layout

\begin_layout Itemize
Applying laplace transform on above equation results : 
\begin_inset Formula $s^{2}X(s)-s+X(s)-Y(s)=0$
\end_inset

 ,
\begin_inset Formula $s^{2}Y(s)+2Y(s)-2X(s)=0$
\end_inset

 solving these two equations result in 
\begin_inset Formula $X(s)=\frac{2+s^{2}}{s^{3}+3s}$
\end_inset

 
\begin_inset Formula $Y(s)=\frac{2}{s^{3}+3s}$
\end_inset

.
\end_layout

\begin_layout Itemize
These transfer functions can be used as input of sp.impulse functions which
 returns impulse response ie 
\begin_inset Formula $x(t)$
\end_inset

 
\begin_inset Formula $y(t)$
\end_inset

.
 The plot of 
\begin_inset Formula $x(t)y(t)$
\end_inset

 are in figure 3.
\begin_inset Formula 
\[
2\ddot{x}+\ddot{y}=0
\]

\end_inset


\begin_inset Formula 
\[
2\dot{x}+\dot{y}=0
\]

\end_inset


\begin_inset Formula 
\[
2x+y=2
\]

\end_inset


\end_layout

\begin_layout Itemize
The relation between the two differential equations is 
\begin_inset Formula $2x(t)+y(t)=2$
\end_inset

 which is linear .
 The corresponding plot is shown in figure 4.
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement H
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset Formula $x(t),y(t)$
\end_inset

satisfying 
\begin_inset Formula $\ddot{x}+(x-y)=0,\ddot{y}+2(y-x)=0$
\end_inset

 with initial conditions 
\begin_inset Formula $x(0)=1,\dot{x}(0)=\dot{y}(0)=y(0)=0$
\end_inset


\end_layout

\end_inset


\begin_inset Graphics
	filename Figure_3.png
	width 80page%
	height 40pheight%

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\begin_inset Float figure
placement H
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset Formula $x(t)$
\end_inset

vs
\begin_inset Formula $y(t)$
\end_inset

for given coupled spring
\end_layout

\end_inset


\begin_inset Graphics
	filename Figure_4.png
	width 80page%
	height 40pheight%

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Code
\end_layout

\begin_layout LyX-Code
#problem 4
\end_layout

\begin_layout LyX-Code
numx = poly1d([1,0,2])
\end_layout

\begin_layout LyX-Code
denx = poly1d([1,0,3,0])
\end_layout

\begin_layout LyX-Code
X = sp.lti(numx,denx)
\end_layout

\begin_layout LyX-Code
numy = poly1d([2])
\end_layout

\begin_layout LyX-Code
deny = poly1d([1,0,3,0])
\end_layout

\begin_layout LyX-Code
Y = sp.lti(numy,deny)
\end_layout

\begin_layout LyX-Code
t,x=sp.impulse(X,None,linspace(0,20,201))
\end_layout

\begin_layout LyX-Code
t,y=sp.impulse(Y,None,linspace(0,20,201))
\end_layout

\begin_layout LyX-Code
plt.figure(3)
\end_layout

\begin_layout LyX-Code
title('Coupled spring')
\end_layout

\begin_layout LyX-Code
plot(t,x)
\end_layout

\begin_layout LyX-Code
plot(t,y)
\end_layout

\begin_layout LyX-Code
plt.legend(['$x(t)$','$y(t)$'])
\end_layout

\begin_layout LyX-Code
plt.figure(4)
\end_layout

\begin_layout LyX-Code
title('plot of x vs y for coupled spring')
\end_layout

\begin_layout LyX-Code
xlabel('$x(t)$',fontsize=20)
\end_layout

\begin_layout LyX-Code
ylabel('$y(t)$',fontsize=20)
\end_layout

\begin_layout LyX-Code
plot(x,y)
\end_layout

\begin_layout LyX-Code

\end_layout

\begin_layout Section
RLC network .
\end_layout

\begin_layout Subsection
Method and Discussion
\end_layout

\begin_layout Itemize
The transfer function of series lcr network is given as 
\begin_inset Formula $H(s)=\frac{1}{s^{2}LC+sCR+1}$
\end_inset

 where 
\begin_inset Formula $LC=1e^{-12}$
\end_inset

 
\begin_inset Formula $RC=1e^{-4}$
\end_inset

.The input is sinusoid of two frequencies 
\begin_inset Formula $v_{i}(t)=\cos(10^{3}t)u(t)-\cos(10^{6}t)u(t)$
\end_inset

.
\end_layout

\begin_layout Itemize
The output voltage is obtained by giving 
\begin_inset Formula $H(s)$
\end_inset


\begin_inset Formula $v_{i}(t)$
\end_inset

 to sp.lsim function.
\end_layout

\begin_layout Itemize
The magnitude and phase can be obtained by using bode function.
 It is implemented as 
\begin_inset Formula $w,S,phi=H.bode()$
\end_inset

.S has magnitude in dB, phi has phase in degree.
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement H
wide false
sideways false
status collapsed

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Bode plot of 
\begin_inset Formula $H(s)=\frac{1}{s^{2}10^{-12}+s10^{-4}+1}$
\end_inset


\end_layout

\end_inset


\begin_inset Graphics
	filename Figure_5.png
	width 80page%
	height 40pheight%

\end_inset


\end_layout

\end_inset


\begin_inset Float figure
placement H
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Voltage across capacitor 
\end_layout

\end_inset


\begin_inset Graphics
	filename Figure_6.png
	width 80page%
	height 40pheight%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Graphics
	filename Figure_7.png
	width 80page%
	height 40pheight%

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\begin_inset Float figure
placement H
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Plot of 
\begin_inset Formula $v_{o}(t)$
\end_inset

and 
\begin_inset Formula $\cos(10^{3}t)$
\end_inset


\end_layout

\end_inset


\begin_inset Graphics
	filename Figure_8.png
	width 80page%
	height 40pheight%

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Itemize
The output of system for sinusoid of frequency 
\begin_inset Formula $\omega$
\end_inset

is 
\begin_inset Formula $|H(j\omega)|\cos(\omega t+\angle H(j\omega)$
\end_inset

.From bode plot it is clear that for frequency of 
\begin_inset Formula $10^{3}$
\end_inset


\begin_inset Formula $H(j\omega)\thickapprox1$
\end_inset

 and 
\begin_inset Formula $\angle H(j\omega)\thickapprox0$
\end_inset

 but frequency 
\begin_inset Formula $10^{6}$
\end_inset

is attenuated more.
 Therefore the output is nearly 
\begin_inset Formula $\cos(10^{3}t)$
\end_inset

 with some phase shift shown in figure 8.
\end_layout

\begin_layout Itemize

\end_layout

\begin_layout Subsection
Code
\end_layout

\begin_layout LyX-Code
#problem5
\end_layout

\begin_layout LyX-Code
#H(s) = 1/(s2LC+SCR+1) LC = e-12,RC = e-4
\end_layout

\begin_layout LyX-Code
num = poly1d([1])
\end_layout

\begin_layout LyX-Code
den = poly1d([pow(10,-12),pow(10,-4),1])
\end_layout

\begin_layout LyX-Code
H = sp.lti(num,den)
\end_layout

\begin_layout LyX-Code
w,S,phi=H.bode()
\end_layout

\begin_layout LyX-Code
title('Magnitude and phase response of steady state transfer function')
\end_layout

\begin_layout LyX-Code
plt.figure(5)
\end_layout

\begin_layout LyX-Code
subplot(2, 1, 1)
\end_layout

\begin_layout LyX-Code
ylabel('$Magnitude(dB)$')
\end_layout

\begin_layout LyX-Code
semilogx(w,S)
\end_layout

\begin_layout LyX-Code
subplot(2, 1, 2)
\end_layout

\begin_layout LyX-Code
ylabel('$Phase(deg)$')
\end_layout

\begin_layout LyX-Code
xlabel('$
\backslash
omega(rad/s)$')
\end_layout

\begin_layout LyX-Code
semilogx(w,phi)
\end_layout

\begin_layout LyX-Code
t =arange(0,0.01,pow(10,-7))
\end_layout

\begin_layout LyX-Code
u = cos(pow(10,3)*t) - cos(pow(10,6)*t)
\end_layout

\begin_layout LyX-Code
num = poly1d([1])
\end_layout

\begin_layout LyX-Code
den = poly1d([pow(10,-12),pow(10,-4),1])
\end_layout

\begin_layout LyX-Code
H = sp.lti(num,den)
\end_layout

\begin_layout LyX-Code
t,y,svec=sp.lsim(H,u,t)
\end_layout

\begin_layout LyX-Code
plt.figure(6)
\end_layout

\begin_layout LyX-Code
title('output voltage for 10m sec')
\end_layout

\begin_layout LyX-Code
ylabel('$V_o(t)$')
\end_layout

\begin_layout LyX-Code
xlabel('$t$')
\end_layout

\begin_layout LyX-Code
plot(t,y)
\end_layout

\begin_layout LyX-Code
plt.figure(8)
\end_layout

\begin_layout LyX-Code
plot(t,y)
\end_layout

\begin_layout LyX-Code
plot(t,cos(pow(10,3)*t))
\end_layout

\begin_layout LyX-Code
plt.legend(['$V_o(t)$','$cos(10^3t)u(t)$'])
\end_layout

\begin_layout LyX-Code
t =arange(0,3*pow(10,-5),pow(10,-7))
\end_layout

\begin_layout LyX-Code
u = cos(pow(10,3)*t) - cos(pow(10,6)*t)
\end_layout

\begin_layout LyX-Code
num = poly1d([1])
\end_layout

\begin_layout LyX-Code
den = poly1d([pow(10,-12),pow(10,-4),1])
\end_layout

\begin_layout LyX-Code
H = sp.lti(num,den)
\end_layout

\begin_layout LyX-Code
t,y,svec=sp.lsim(H,u,t)
\end_layout

\begin_layout LyX-Code
plt.figure(7)
\end_layout

\begin_layout LyX-Code
title('output voltage for 0<t<30usec')
\end_layout

\begin_layout LyX-Code
ylabel('$V_o(t)$')
\end_layout

\begin_layout LyX-Code
xlabel('$t$')
\end_layout

\begin_layout LyX-Code
plot(t,y)
\end_layout

\begin_layout LyX-Code
show()
\end_layout

\end_body
\end_document
